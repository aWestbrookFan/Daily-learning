Node的模块实现

在node中引入模块，需要经历如下3个步骤。

1. 路径分析

2. 文件定位

3. 编译执行

在Node中，模块分为两类：一类是Node 提供的模块，成为核心模块；另一类

是用户编写的模块，称为文件模块。

核心模块部分在Node源代码编译过程中，编译进了二进制执行文件。在Node

进程启动时候，部分核心模块直接已经加载到了进程。

文件模块是在运行时候进行加载的，需要完成的路径分析、文件定位、编译执行过程。

详细的加载模块：

1. 优先从缓存加载

   Node 对引入的模块进行缓存  以减少二次引入时的开销。（不管是核心模块还是文件模块），Node缓存的是**编译和执行之后的对象**，而浏览器缓存的仅仅是文件。

2. 路径分析和文件定位

   1. 路径分析

      标识符有几种形式，不同的标识符，模块的查找和定位会有不同的程度上的差异。

      标识符分类：1. 核心模块，如`http`、`fs`、`path`等。2. `.`或`..`开始的相对路径文件模块。

      3. 以/开始的绝对路径文件模块。4. 非路径形式的文件模块，如自定义的`connect`模块

      **核心模块的加载**: 优先级仅次于缓存加载。

      **路径形式的文件模块：** 以 **.**  、**..** 、**/** 开始的标识符,这里都被当做文件模块来处理。在分析路径模块时候，require()方法会将路径转换成真实路径，并且以真实路径作为索引。将编译的结果放在缓存中，以使二次加载时更快。

   2. 文件定位

3. 模块编译

